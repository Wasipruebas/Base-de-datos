<script>
  const q = document.getElementById("q");
  const out = document.getElementById("out");
  let productos = [];

  function norm(s){ return (s||"").toLowerCase().trim(); }

  fetch("productos.csv")
    .then(r => r.text())
    .then(text => {
      const rows = text.split("\n").slice(1);
      productos = rows.map(r => {
        const [nombre, bulto] = r.split(",");
        return { nombre: nombre?.trim(), bulto: bulto?.trim() };
      });
    });

  q.addEventListener("input", () => {
    const term = norm(q.value);
    if(!term){
      out.textContent = "Esperando búsqueda…";
      return;
    }

    const found = productos.find(p => norm(p.nombre).includes(term));
    if(!found){
      out.innerHTML = `<b>Sin resultados</b><div class="muted">Probá con otro nombre.</div>`;
      return;
    }

    out.innerHTML = `
      <b>${found.nombre}</b>
      <div>Bulto: <b>${found.bulto}</b> unidades</div>
    `;
  });
</script>
